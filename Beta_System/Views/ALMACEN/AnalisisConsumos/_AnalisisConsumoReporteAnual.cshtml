@model List<Beta_System.Models.REPORTE_ALMACEN_AnalisisConsumosAnual>

<table class="table table-striped table-bordered small" id="tabla_consumos_articulos">
    <thead>
        <tr class="text-center bg-beta">
            <th>Clave</th>
            <th style="width: 40%;">Articulo</th>
            <th>Uni. medida</th>
            <th>Ubicacion</th>

            <th>Existencia actual</th>
            <th>Precio promedio</th>
            <th>Costo inventario</th>

            <th>Enero</th>
            <th>Monto</th>
            <th>Febrero</th>
            <th>Monto</th>
            <th>Marzo</th>
            <th>Monto</th>
            <th>Abril</th>
            <th>Monto</th>
            <th>Mayo</th>
            <th>Monto</th>
            <th>Junio</th>
            <th>Monto</th>
            <th>Julio</th>
            <th>Monto</th>
            <th>Agosto</th>
            <th>Monto</th>
            <th>Septiembre</th>
            <th>Monto</th>
            <th>Octubre</th>
            <th>Monto</th>
            <th>Noviembre</th>
            <th>Monto</th>
            <th>Diciembre</th>
            <th>Monto</th>

            <th>Promedio mensual consumos</th>
            <th>Dias de inventario</th>
            <th>Mantener en stock</th>

        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Select(x => x.id_articulo).Distinct())
        {
            var data_art = Model.Where(x => x.id_articulo == item).FirstOrDefault();
            decimal costo_inventario = Convert.ToDecimal(data_art.Precio) * Convert.ToDecimal(data_art.ExistenciaActual);
            <tr class="text-center">
                <td>@data_art.Clave</td>
                <td class="text-left" >@data_art.Nombre_articulo</td>
                <td>@data_art.Unidad_medida</td>
                <td>@data_art.Ubicacion</td>

                <td>@Convert.ToDecimal(data_art.ExistenciaActual).ToString("N2")</td>
                <td>$@Convert.ToDecimal(data_art.Precio).ToString("N2")</td>
                <td>$@costo_inventario.ToString("N2")</td>

                @for (int i = 1; i <= 12; i++)
                {
                    var valor = Model.Where(x => x.No_mes == i && x.id_articulo == item && x.Cantidad > 0).FirstOrDefault();
                    if (valor == null)
                    {
                        <td>0</td>
                        <td>0</td>
                    }
                    else
                    {
                        decimal consumo_monto = valor.Cantidad * Convert.ToDecimal(data_art.Precio);
                        <td>@valor.Cantidad.ToString("N2")</td>
                        <td>@consumo_monto.ToString("N2")</td>
                    }
                }

                <td>@data_art.PromedioMensual.ToString("N2")</td>
                <td>@data_art.DiasInventario.ToString("N2")</td>
                @if (data_art.DiasInventario > 0)
                {
                    /* <td><i class="fa fa-2x fa-check" style="color:lightgreen;"></i></td> */
                    <td>SI</td>
                }
                else
                {
                    /*  <td><i class="fa fa-2x fa-remove" style="color:darkred;"></i></td> */
                    <td class="text-danger">NO</td>
                }

            </tr>
        }
    </tbody>
</table>

