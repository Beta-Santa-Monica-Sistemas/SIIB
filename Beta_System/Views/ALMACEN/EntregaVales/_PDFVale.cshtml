@model IEnumerable<Beta_System.Models.C_almacen_solicitudes_mercancia_d>

@if (Model.Count() > 0)
{
    var solicitud = Model.FirstOrDefault().C_almacen_solicitudes_mercancia_g;
    var id_almacen = solicitud.id_almacen_g;
    <div class="row">
        <div class="col-md-2 text-left">
            <img src="~/Content/img_layout/logo_beta_new.png" width="250;" style="margin-left: 5%;">
        </div>
        <div class="col-md-10 text-center">
            <h1><strong>BETA SANTA MONICA S.P.R. DE R.L. DE C.V.</strong></h1>
            <h2 style="margin:10px;">SOLICITUD DE MERCANCIA</h2>
        </div>
    </div>
    <hr />
    <div class="row" style="border-bottom: double 5px;">
        <div class="col-md-2">
            <h3 style="margin: 5px;"><strong>Concepto:</strong></h3>
            <h3 style="margin: 5px;"><strong>Fecha registro:</strong></h3>
            <h3 style="margin: 5px;"><strong>Folio:</strong></h3>
            <h3 style="margin: 5px;"><strong>Centro:</strong></h3>
            <h3 style="margin: 5px;"><strong>Departamento:</strong></h3>
            <h3 style="margin: 5px;"><strong>Equipo:</strong></h3>
            @try
            {
                if (solicitud.C_alimentacion_productores != null)
                {
                    <h3 style="margin: 5px;"><label style="margin: 0px;">Productor:</label></h3>
                }
            }
            catch (Exception){}
        </div>
        <div class="col-md-8">
            <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.cargo_desc</label></h3>
            <h3 style="margin: 5px;"><label style="margin: 0px;">@String.Format(solicitud.fecha_registro.ToString(), "dd/MM/yyyy")</label></h3>
            <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.C_centros_g.siglas @solicitud.id_solicitud_mercancia_g</label></h3>
            <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.C_centros_g.nombre_centro</label></h3>
            <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.C_departamentos_g.siglas @solicitud.C_departamentos_g.nombre_departamento</label></h3>
            <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.C_establos_equipos.clave_equipo @solicitud.C_establos_equipos.nombre_equipo</label></h3>
            @try
            {
                if (solicitud.C_alimentacion_productores != null)
                {
                    <h3 style="margin: 5px;"><label style="margin: 0px;">@solicitud.C_alimentacion_productores.nombre_productor (@solicitud.C_alimentacion_productores.C_alimentacion_productores_origenes.nombre_origen)</label></h3>
                }
            }
            catch (Exception){}
        </div>
        <div class="col-md-2 text-left">
            <h4><strong>@solicitud.C_almacen_solicitudes_status.nombre_status: @String.Format(solicitud.fecha_autorizacion.Value.ToShortDateString(), "dd/MM/yyyy") | @solicitud.C_usuarios_corporativo1.usuario</strong></h4>
            <h4><strong>Fecha/Hora Impresion: @String.Format(DateTime.Now.ToString(), "dd/MM/yyyy HH:MM:ss")</strong></h4>
        </div>
    </div>
    <br />
    <table class="table" id="tabla_solicitudes_detalle" style="width:100%;">
        <thead>
            <tr class="text-center" style="border-bottom: double 5px; font-size:20px;">
                <th>Clave</th>
                <th>Articulo</th>
                <th>Unidad</th>
                <th>Ubicación</th>
                <th>Cantidad solicitada</th>
                <th>Cantidad entregada</th>
                <th>Surtido</th>
                <th>Pendiente</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.OrderBy(x => x.C_articulos_catalogo.nombre_articulo))
            {
                <tr class="text-center" style="font-size: 18px;">
                    <td>@item.C_articulos_catalogo.clave</td>
                    <td class="text-left">
                        <label style="margin: 5px;">@item.C_articulos_catalogo.nombre_articulo</label>
                        <br />
                        <label style="font-size: 16px;">@item.C_cargos_contables_g.nombre_cargo: @item.C_cuentas_contables_g.nombre_cuenta - @item.C_cuentas_contables_g.cuenta</label>
                    </td>
                    <td>@item.C_unidades_medidas.unidad_medida</td>

                    <td>
                        @try
                        {
                            if (item.C_articulos_catalogo.C_inventario_almacenes_articulos.Count() > 0)
                            {
                                var valid_establo = item.C_articulos_catalogo.C_inventario_almacenes_articulos.Where(x => x.id_almacen == id_almacen && x.activo == true);
                                if (valid_establo != null)
                                {
                                    <strong class="text-success">@valid_establo.FirstOrDefault().C_almacen_ubicaciones_articulos.nombre_ubicacion</strong>
                                }
                                else
                                {
                                    <strong class="text-danger">NO ASIGNADA</strong>
                                }
                            }
                            else
                            {
                                <strong class="text-danger">NO ASIGNADA</strong>
                            }
                        }
                        catch (Exception)
                        {
                            <strong class="text-danger">NO ASIGNADA</strong>
                        }
                    </td>

                    <td>@item.cantidad</td>
                    <td>@item.cantidad_entregada</td>
                    <td>
                        @if (item.entregado == true)
                        {<strong><i class="fa fa-check"></i></strong>}
                    </td>
                    <td>
                        @if (item.entregado == false)
                        {<strong><i class="fa fa-check"></i></strong>}
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="row" style="margin-top:7%;">
        <div class="col-md-6 text-center">
            <div class="row">
                <div class="col-md-2"></div>
                <div class="col-md-6 text-center">
                    <h3 style="margin:0px; font-size:20px;"><label style="border-bottom:2px solid black">@solicitud.C_empleados.nombres @solicitud.C_empleados.apellido_paterno</label></h3>
                    <strong style="margin:0px; font-size: 18px;">Solicitante</strong>
                </div>
                <div class="col-md-2"></div>
            </div>
        </div>
        <div class="col-md-6 text-center">
            <div class="row">
                <div class="col-md-2"></div>
                <div class="col-md-6 text-center">
                    <h3 style="margin: 0px; border-bottom: 2px solid black"><label></label></h3>
                    <strong style="margin:0px; font-size: 18px;">Autorizacion</strong>
                </div>
                <div class="col-md-2"></div>
            </div>
        </div>
    </div>
}

