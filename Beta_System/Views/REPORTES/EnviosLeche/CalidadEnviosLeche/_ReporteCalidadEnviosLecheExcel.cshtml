@model IEnumerable<Beta_System.Models.C_envios_leche_d_fichas>

@if (Model.Count() > 0)
{
    foreach (var cliente in Model.GroupBy(x => x.C_envios_leche_g.id_envio_leche_cliente_ms))
    {

        <h3 class="text-left bg-beta p-2" style="margin:0px;">Cliente @cliente.FirstOrDefault().C_envios_leche_g.C_envios_leche_clientes.nombre_comercial</h3>
        <div class="table-responsive">
            <table class="table table-striped table-bordered table-sm table-condensed datatable_calidad_leche">
                <thead>
                    <tr>
                        <th class="bg-red" colspan="7">ENVIO</th>
                        <th class="bg-green" colspan="18">RESULTADOS DE CALIDAD</th>
                    </tr>
                    <tr class="bg-beta text-center">
                        <th class="bg-dark text-white headerConcepto">Fecha</th>
                        <th class="bg-dark text-white headerConcepto">Establo</th>
                        <th class="bg-dark text-white headerConcepto">Folio</th>
                        <th class="bg-dark text-white headerConcepto">Destino</th>
                        <th class="bg-dark text-white headerConcepto">Litros</th>
                        <th class="bg-dark text-white headerConcepto">Ficha</th>
                        <th class="bg-dark text-white headerConcepto">Tanque</th>
                        <th class="bg-dark text-white headerConcepto">Muestra</th>
                        <th class="bg-dark text-white headerConcepto">Sala</th>
                        <th class="bg-dark text-white headerConcepto">ATB.</th>
                        <th class="bg-dark text-white headerConcepto">Temp.</th>
                        <th class="bg-dark text-white headerConcepto">Grasa</th>
                        <th class="bg-dark text-white headerConcepto">Proteina</th>
                        <th class="bg-dark text-white headerConcepto">SNG</th>
                        <th class="bg-dark text-white headerConcepto">ST</th>
                        <th class="bg-dark text-white headerConcepto">Lactosa</th>
                        <th class="bg-dark text-white headerConcepto">Caseina</th>
                        <th class="bg-dark text-white headerConcepto">Acidez</th>
                        <th class="bg-dark text-white headerConcepto">Criosc.</th>
                        <th class="bg-dark text-white headerConcepto">Urea</th>
                        <th class="bg-dark text-white headerConcepto">Betalac.</th>
                        <th class="bg-dark text-white headerConcepto">Tetrac.</th>
                        <th class="bg-dark text-white headerConcepto">Aflatox</th>
                        <th class="bg-dark text-white headerConcepto">Sulfas.</th>
                        <th class="bg-dark text-white headerConcepto">Alchol 75%</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in cliente.GroupBy(x => x.id_envio_leche_g))
                    {
                        <tr>
                            <td>@item.FirstOrDefault().C_envios_leche_g.fecha_envio</td>
                            <td>@item.FirstOrDefault().C_envios_leche_g.C_establos.nombre_establo</td>
                            <td>@item.FirstOrDefault().C_envios_leche_g.folio</td>
                            <td>@item.FirstOrDefault().C_envios_leche_g.C_envios_leche_destinos.nombre_destino</td>
                            <td>@item.FirstOrDefault().C_envios_leche_g.litros_totales</td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.id_ficha_bascula</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.tanque</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().muestra_calidad</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().sala</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    switch (@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().antibiotico)
                                    {
                                        case -1:
                                            <label style="display:block">
                                                Ninguno
                                            </label>
                                            break;
                                        case 0:
                                            <label style="display:block">
                                                Negativo
                                            </label>
                                            break;
                                        case 1:
                                            <label style="display:block">
                                                Positivo
                                            </label>
                                            break;
                                    }
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().temperatura</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().grasa</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().proteina</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().solidos_no_grasos</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().solidos_totales</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().lactosa</label>
                                }
                            </td>

                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().caseina</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().acidez</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().crioscopia</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().urea</label>
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    switch (@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().betalactamicos)
                                    {
                                        case -1:
                                            <label style="display:block">
                                                Ninguno
                                            </label>
                                            break;
                                        case 0:
                                            <label style="display:block">
                                                Negativo
                                            </label>
                                            break;
                                        case 1:
                                            <label style="display:block">
                                                Positivo
                                            </label>
                                            break;
                                    }
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    switch (@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().tetraciclina)
                                    {
                                        case -1:
                                            <label style="display:block">
                                                Ninguno
                                            </label>
                                            break;
                                        case 0:
                                            <label style="display:block">
                                                Negativo
                                            </label>
                                            break;
                                        case 1:
                                            <label style="display:block">
                                                Positivo
                                            </label>
                                            break;
                                    }
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    switch (@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().aflatoxinas)
                                    {
                                        case -1:
                                            <label style="display:block">
                                                Ninguno
                                            </label>
                                            break;
                                        case 0:
                                            <label style="display:block">
                                                Negativo
                                            </label>
                                            break;
                                        case 1:
                                            <label style="display:block">
                                                Positivo
                                            </label>
                                            break;
                                    }
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    switch (@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().sulfasimas)
                                    {
                                        case -1:
                                            <label style="display:block">
                                                Ninguno
                                            </label>
                                            break;
                                        case 0:
                                            <label style="display:block">
                                                Negativo
                                            </label>
                                            break;
                                        case 1:
                                            <label style="display:block">
                                                Positivo
                                            </label>
                                            break;
                                    }
                                }
                            </td>
                            <td>
                                @foreach (var fichass in item)
                                {
                                    <label style="display:block">@fichass.C_envios_leche_d_calidad.Where(x => x.id_envio_leche_d_ficha == fichass.id_envio_leche_d).FirstOrDefault().alcohol_75</label>
                                }
                            </td>
                        </tr>

                    }

                </tbody>
            </table>
        </div>

    }
}
else
{
    <div class="col-md-12 text-center">
        <h2 style="color:red">No se encontró información</h2>
    </div>
}