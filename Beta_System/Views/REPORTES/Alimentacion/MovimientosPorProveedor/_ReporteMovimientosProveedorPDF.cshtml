@model List<Beta_System.Models.C_bascula_fichas>


    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!--ICONO DE LA PAGINA-->
    <link rel="icon" type="image/png" href="~/Content/img_layout/Logo_beta_icono.png" />

    <meta http-equiv="Last-Modified" content="0">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>BETA System</title>

    <!-- bootstrap css -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">


    <!-- site css -->
    <link rel="stylesheet" href="~/Content/style.css" />
    <!-- responsive css -->
    <link rel="stylesheet" href="~/Content/css/responsive.css" />
    <!-- color css -->
    <link rel="stylesheet" href="~/Content/css/color_2.css" />
    <!-- select bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/css/bootstrap-select.min.css" integrity="sha512-ARJR74swou2y0Q2V9k0GbzQ/5vJ2RBSoCWokg4zkfM29Fb3vZEQyv0iWBMW/yvKgyHSR/7D64pFMmU8nYmbRkg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- scrollbar css -->
    <link rel="stylesheet" href="~/Content/css/perfect-scrollbar.css" />
    <!-- custom css -->
    <link rel="stylesheet" href="~/Content/production/css/custom.css" />
    <!-- calendar file css -->
    <link rel="stylesheet" href="~/Content/css/semantic.min.css" />

    <link rel="stylesheet" href="~/Content/css/animate.css" />

    <link href="~/Content/production/css/select/select2.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.css" integrity="sha512-DIW4FkYTOxjCqRt7oS9BFO+nVOwDL4bzukDyDtMO7crjUZhwpyrWBFroq+IqRe6VnJkTpRAS6nhDvf0w+wHmxg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link href="~/Content/production/css/font-awesome.css" rel="stylesheet" />
    <link href="~/Content/production/css/font-awesome-animation.min.css" rel="stylesheet" />
    <link href="~/Content/production/fonts/css/font-we" rel="stylesheet" />

    <!--jquery-->
    <link rel="stylesheet" href="~/Content/production/css/datatables/css/jquery.dataTables.css" />
    <link href="~/Content/production/css/datatables/css/datatables_select.min.css" rel="stylesheet" />

    @Styles.Render("~/AdminBundles/CSS_v1")


    <script type="text/javascript" src="~/Content/js/animate.js"></script>
    <script type="text/javascript" src="~/Content/production/js/fixed_table_rc.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/js/bootstrap-select.min.js" integrity="sha512-yDlE7vpGDP7o2eftkCiPZ+yuUyEcaBwoJoIhdXv71KZWugFqEphIS3PU60lEkFaz8RxaVsMpSvQxMBaKVwA5xg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <script type="text/javascript" src="~/Content/documentation/js/jquery-ui-1.13.1/jquery-ui.min.js"></script>

    @Scripts.Render("~/AdminBundles/JS")

    <script src="~/Content/production/js/datatables/pdfmake.min.js"></script>
    <script src="~/Content/production/js/datatables/vfs_fonts.js"></script>
    <script src="~/Content/production/js/datatables/dataTables_select.js"></script>

    <!--JSPDF-->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>

    <!--IZITOAST-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js" integrity="sha512-Zq9o+E00xhhR/7vJ49mxFNJ0KQw1E1TMWkPTxrWcnpfEFDEXgUiwJHIKit93EW/XxE31HSI5GEOW06G6BF1AtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!--eCharts-->
    <script src="~/Content/js/echarts.min.js" type="text/javascript"></script>

    <!--SELECT SEARCH-->
    <script src="~/Content/js/select/select2.full.js"></script>

    <!--CUSTOM JS-->
    <script type="text/javascript" src="~/Content/js/custom.js"></script>

    <!--MOMENT JS-->
    <script type="text/javascript" src="~/Content/moment.min.js"></script>

    <!--BOOTSTRAP JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha512-YK1Mz9UiZmhbFzXgMbl3bO49wZ78Xj3h8TtTBLFHEAEjUBxsEZdXd8Il5RWbhPOyB653bGQDNVGGny2mORZq4A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!--LORD ICONS-->
    <script src="https://cdn.lordicon.com/lordicon-1.1.0.js"></script>

    <link href="~/Content/production/css/datatables/css/datatables_select.min.css" rel="stylesheet" />
    <script src="~/Content/production/js/datatables/dataTables_select.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!--ICONO DE LA PAGINA-->
    <link rel="icon" type="image/png" href="" />

    <meta http-equiv="Last-Modified" content="0">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>BETA System</title>

    <!-- bootstrap css -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">


    <!-- site css -->
    <link rel="stylesheet" href="~/Content/style.css" />
    <!-- responsive css -->
    <link rel="stylesheet" href="~/Content/css/responsive.css" />
    <!-- color css -->
    <link rel="stylesheet" href="~/Content/css/color_2.css" />
    <!-- select bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/css/bootstrap-select.min.css" integrity="sha512-ARJR74swou2y0Q2V9k0GbzQ/5vJ2RBSoCWokg4zkfM29Fb3vZEQyv0iWBMW/yvKgyHSR/7D64pFMmU8nYmbRkg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- scrollbar css -->
    <link rel="stylesheet" href="~/Content/css/perfect-scrollbar.css" />
    <!-- custom css -->
    <link rel="stylesheet" href="~/Content/production/css/custom.css" />
    <!-- calendar file css -->
    <link rel="stylesheet" href="~/Content/css/semantic.min.css" />

    <link rel="stylesheet" href="~/Content/css/animate.css" />

    <link href="~/Content/production/css/select/select2.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.css" integrity="sha512-DIW4FkYTOxjCqRt7oS9BFO+nVOwDL4bzukDyDtMO7crjUZhwpyrWBFroq+IqRe6VnJkTpRAS6nhDvf0w+wHmxg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link href="~/Content/production/css/font-awesome.css" rel="stylesheet" />
    <link href="~/Content/production/css/font-awesome-animation.min.css" rel="stylesheet" />
    <link href="~/Content/production/fonts/css/font-we" rel="stylesheet" />

    <!--jquery-->
    <link rel="stylesheet" href="~/Content/production/css/datatables/css/jquery.dataTables.css" />
    <link href="~/Content/production/css/datatables/css/datatables_select.min.css" rel="stylesheet" />

    @Styles.Render("~/AdminBundles/CSS_v1")


    <script type="text/javascript" src="~/Content/js/animate.js"></script>
    <script type="text/javascript" src="~/Content/production/js/fixed_table_rc.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/js/bootstrap-select.min.js" integrity="sha512-yDlE7vpGDP7o2eftkCiPZ+yuUyEcaBwoJoIhdXv71KZWugFqEphIS3PU60lEkFaz8RxaVsMpSvQxMBaKVwA5xg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <script type="text/javascript" src="~/Content/documentation/js/jquery-ui-1.13.1/jquery-ui.min.js"></script>

    @Scripts.Render("~/AdminBundles/JS")

    <script src="~/Content/production/js/datatables/pdfmake.min.js"></script>
    <script src="~/Content/production/js/datatables/vfs_fonts.js"></script>
    <script src="~/Content/production/js/datatables/dataTables_select.js"></script>

    <!--JSPDF-->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>

    <!--IZITOAST-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js" integrity="sha512-Zq9o+E00xhhR/7vJ49mxFNJ0KQw1E1TMWkPTxrWcnpfEFDEXgUiwJHIKit93EW/XxE31HSI5GEOW06G6BF1AtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!--eCharts-->
    <script src="~/Content/js/echarts.min.js" type="text/javascript"></script>

    <!--SELECT SEARCH-->
    <script src="~/Content/js/select/select2.full.js"></script>

    <!--CUSTOM JS-->
    <script type="text/javascript" src="~/Content/js/custom.js"></script>

    <!--MOMENT JS-->
    <script type="text/javascript" src="~/Content/moment.min.js"></script>

    <!--BOOTSTRAP JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha512-YK1Mz9UiZmhbFzXgMbl3bO49wZ78Xj3h8TtTBLFHEAEjUBxsEZdXd8Il5RWbhPOyB653bGQDNVGGny2mORZq4A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!--LORD ICONS-->
    <script src="https://cdn.lordicon.com/lordicon-1.1.0.js"></script>

    <link href="~/Content/production/css/datatables/css/datatables_select.min.css" rel="stylesheet" />
    <script src="~/Content/production/js/datatables/dataTables_select.js"></script>

    <link rel="stylesheet" href="~/Content/fichaSab.css" />
    <style>
        .parte1 label {
            font-size: 22px;
            display: block;
        }

        .parte2 label {
            font-size: 20px;
            display: block;
        }

        .parte3 label {
            font-size: 18px;
            display: block;
            padding-left: 24px;
        }

        th, td {
            color: black;
            font-weight: 600;
        }
    </style>

    @if (Model.Count() > 0)
    {
    <div class="row">
        <div style="width:20%;margin-left:5%;">
            <img src="~/Content/img_layout/logo_beta_new.png" style="max-width: 80%; width:80%; min-width:80%;" />
        </div>
        <div style="width:45%;">
            <h2 style="margin:3px;">Sistema de Información Integral Beta</h2>
            <h4 style="margin:3pX;">MOVIMIENTOS POR PROVEEDOR</h4>
        </div>
        <div style="width:30%;">
            <h4 style="margin:3pX;">Fecha Inicial: @ViewBag.fecha_inicio</h4>
            <h4 style="margin:3pX;">Fecha Final: @ViewBag.fecha_fin</h4>
        </div>
    </div>

    <table class="table table-striped table-bordered table-sm table-condensed">
        @foreach (var item in Model.GroupBy(x => x.id_compras_proveedor))
        {
        decimal total_toneladas_bascula = 0;
        decimal total_toneladas_env = 0;
        decimal total_precio = 0;
        decimal total_importe = 0;

        <tr class="text-left">
            <th colspan="2">Proveedor</th>
            <th colspan="9">@item.FirstOrDefault().C_compras_proveedores.razon_social (@item.FirstOrDefault().C_compras_proveedores.C_tipos_moneda.clave_fiscal)</th>
        </tr>
        <tr class="text-center bg-dark text-white" style="color: white;">
            <th colspan="5">RECEPCION</th>
            <th colspan="6">FACTURACION</th>
        </tr>
        <tr class="text-center bg-green">
            <th>Fecha</th>
            <th>Establo</th>
            <th>Ficha</th>
            <th>Alimento</th>
            <th>Toneladas</th>
            @*
            <th>Ton. Env.</th>*@
            <th>Fecha</th>
            <th>Factura</th>
            <th>Toneladas</th>
            <th>P.U</th>
            <th>Importe</th>
            <th>Moneda</th>
        </tr>

        foreach (var data in item)
        {
        decimal toneladas_bascula = (decimal)data.peso_t / 1000;
        decimal toneladas_fact = 0;

        string fecha_fact = "";
        string factura = "";
        string P_U = "0";
        decimal importe = 0;
        string valor_importe = "0";
        string moneda = "";

        if (data.C_alimentacion_forrajes_facturas_d != null)
        {
        var valid_fact = data.C_alimentacion_forrajes_facturas_d.Where(x => x.activo == true).FirstOrDefault();
        if (valid_fact != null)
        {
        toneladas_fact = (decimal)valid_fact.toneladas_ficha / 1000;
        fecha_fact = string.Format(valid_fact.C_alimentacion_forrajes_facturas_g.fecha_factura.Value.ToShortDateString(), "dd/MM/yyyy");
        factura = valid_fact.C_alimentacion_forrajes_facturas_g.folio_factura;
        P_U = valid_fact.precio_ficha.ToString();
        importe = Convert.ToDecimal(P_U) * toneladas_fact;
        valor_importe = Math.Round(importe, 3).ToString();
        moneda = valid_fact.C_tipos_moneda.clave_fiscal;
        }

        total_toneladas_bascula += toneladas_bascula;
        total_toneladas_env += toneladas_fact;
        total_precio += Convert.ToDecimal(P_U);
        total_importe += Convert.ToDecimal(valor_importe);
        <tr>
            <td>@string.Format(data.fecha_registo.Value.ToShortDateString(), "dd/MM/yyyy")</td>
            <td>@data.C_establos.siglas.ToUpper()</td>
            <td>@data.id_bascula_ficha</td>
            <td class="text-left">@data.C_articulos_catalogo.nombre_articulo</td>
            <td>@toneladas_bascula</td>
            @*
            <td>0</td>*@
            <td>@fecha_fact</td>
            <td>@factura</td>

            @if (toneladas_fact != 0)
            {
            <td>@toneladas_fact</td>
            }
            else
            {
            <td></td>
            }

            @if (P_U != "0")
            {
            <td>@P_U</td>
            }
            else
            {
            <td></td>
            }

            @if (valor_importe != "0")
            {
            <td>@valor_importe</td>
            }
            else
            {
            <td></td>
            }

            <td>@moneda</td>
        </tr>
        }
        }
        <tr class="bg-green text-white" style="color: white;">
            <td style="font-weight:800;">Total</td>
            <td></td>
            <td></td>
            <td></td>
            <td style="font-weight:800;">@total_toneladas_bascula</td>
            @*
            <td>0</td>*@
            <td></td>
            <td></td>
            <td style="font-weight:800;">@total_toneladas_env</td>
            <td style="font-weight:800;">@total_precio</td>
            <td style="font-weight:800;">@total_importe</td>
            <td></td>
        </tr>
        }
    </table>

    }
    else
    {
    <table class="table table-striped table-bordered">
        <tr>
            <td>No se encontraron registros</td>
        </tr>
    </table>
    }



