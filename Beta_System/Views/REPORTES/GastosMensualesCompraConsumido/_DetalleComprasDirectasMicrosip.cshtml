@model List<Beta_System.Models.GastosMensualesMS.DOCTOS_CP_IMPORTES_PROVEEDORES>

@{
    decimal importe = 0;
}


@if (Model.Count() > 0 || Model != null)
{

    <div class="row">
        <div class="col-md-6">
            <h4 style="margin:3px;"><strong>@ViewBag.nombre_cargo</strong></h4>
            @foreach (var item in Model.Select(x => x.Cuenta).Distinct())
            {
                <label style="margin:3px;"><label>@item   @Model.Where(x => x.Cuenta == item).FirstOrDefault().Cuenta_Concepto</label></label><br />
            }
        </div>
        <div class="col-md-6 text-right">
            <h4><strong>Importe compras directas: $ @Model.Select(x => x.Importe).Sum().ToString("N2")</strong></h4>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table table-striped table-bordered" id="datatable_compras_directas_detalle">
            <thead>
                <tr class="bg-beta text-center">
                    <th>Fecha Microsip</th>
                    <th>Referencia</th>
                    <th style="width:40%;">Descripción</th>

                    <th>Requisición</th>
                    <th>Fecha requisición</th>
                    <th>Observaciones</th>

                    <th>Clave prov.</th>
                    <th>Proveedor</th>
                    <th>Importe $</th>
                    <th>Cuenta</th>
                    <th>Nombre cta.</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    string observaciones_requi = "";
                    if (item.folio_requisicion != "N/A"){
                        try{ observaciones_requi = item.observaciones.Substring(0, item.observaciones.Length - 2); }
                        catch (Exception) { }
                    }


                    <tr class="text-center">
                        <td>@string.Format(item.Fecha.ToShortDateString(), "dd/mm/yyyy")</td>
                        <td>@item.Folio</td>
                        <td>@item.Descripcion</td>

                        @if (item.folio_requisicion != "N/A")
                        {
                            <td>@item.folio_requisicion</td>
                            <td>@string.Format(item.fecha_requisicion.ToShortDateString(), "dd/mm/yyyy")</td>
                            <td>@observaciones_requi</td>
                        }
                        else
                        {
                            <td>@item.folio_requisicion</td>
                            <td></td>
                            <td>@item.observaciones</td>
                        }


                        <td>@item.Clave_Prov</td>
                        <td>@item.Nombre_Proveedor</td>
                        <td>$@item.Importe.ToString("N2")</td>
                        <td>@item.Cuenta</td>
                        <td>@item.Cuenta_Concepto</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

else
{
    <h2 class="text-danger text-center">No se encontraron registros</h2>
    }







