@model IEnumerable<Beta_System.Models.C_envios_leche_programacion_diaria_d>
@{
    int estatus = ViewBag.ProduccionEstatus;
    List<string> diasProduccion = ViewBag.DiasProduccionEstimada as List<string>;
    List<int> idDiasProduccion = ViewBag.IdDiasProduccionEstimada as List<int>;
    List<string> diasNombreProduccion = ViewBag.NombreProduccionEstimada as List<string>;
    int establo_existe = 0;

    if (Model.Select(x => x.C_envios_leche_programacion_diaria_g.id_establo).Distinct().Count() >= 2)
    {
        establo_existe = 1;
    }
}

@if (Model.Count() > 0)
{
    <div class="col-md-12 text-center" style="display:none">
        <label id="existe_programacion_semanal">@estatus</label><br />
        <label id="existe_programacion_semanal_establo">@establo_existe</label>
    </div>

    foreach (var id_Dias in idDiasProduccion)
    {
        <label style="display:none" class="id_dias_estimacion">@id_Dias</label>
    }
    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-bordered text-center" id="datatable_consulta_produccion_estimada" style="width:100%;">
                <thead>
                    <tr class="bg-beta text-center">
                        <th>Establo</th>
                        @for (int i = 0; i < idDiasProduccion.Count(); i++)
                        {
                            <th class="encabezado_estimacion_dia" id="estimacion_id_dia_@idDiasProduccion[i]">
                                <strong>@diasProduccion[i]</strong>
                                <br />
                                <label class="encabezado_nombre_estimacion_dia">@diasNombreProduccion[i]</label>
                            </th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.GroupBy(x => x.id_programacion_diaria_g).Distinct())
                    {

                        <tr>
                            @{
                                var establo = @item.FirstOrDefault().C_envios_leche_programacion_diaria_g.id_establo + "_";
                            }
                            <td id="@item.FirstOrDefault().id_programacion_diaria_g" class="estimacion_establos">@item.FirstOrDefault().C_envios_leche_programacion_diaria_g.C_establos.nombre_establo</td>
                            @foreach (var items in Model.Where(x => x.id_programacion_diaria_g == item.FirstOrDefault().id_programacion_diaria_g))
                            {
                                double total = Convert.ToDouble((items.produccion + items.sobrante) - items.faltante);
                                <td class="estimacion_dia_@establo@items.id_dia_presupuesto">@total</td>
                            }

                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
}
else
{
    <div class="col-md-12 text-center">
        <h3 style="color:red">Produccion sin registrar</h3>
    </div>
}