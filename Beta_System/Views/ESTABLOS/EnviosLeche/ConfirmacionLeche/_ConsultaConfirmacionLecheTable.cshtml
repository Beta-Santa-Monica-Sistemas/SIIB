@model IEnumerable<Beta_System.Models.C_envios_leche_d_fichas>

@if (Model.Count() > 0)
{
    <table class="table table-striped table-bordered" id="tabla_confirmacion_leche" data-toggle="table" data-search="true">
        <thead>
            <tr class="bg-beta text-center">
                <th style="max-width:12%; min-width:12%">Establo</th>
                <th style="max-width:6%; min-width:6%">Fecha</th>
                <th style="max-width:11%; min-width:11%">Producto</th>
                <th style="max-width:22%; min-width:22%">Cliente</th>
                <th style="max-width:22%; min-width:22%">Destino</th>
                <th style="max-width:8%; min-width:8%">Folio</th>
                <th style="max-width:8%; min-width:8%">Litros</th>
                <th style="max-width:6%; min-width:6%">Confirmacion</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var group in Model.GroupBy(x => x.id_envio_leche_g))
            {
                var firstItem = group.FirstOrDefault();
                DateTime horas = Convert.ToDateTime(firstItem.C_envios_leche_g.fecha_registro);
                var ficha1 = group.ElementAtOrDefault(0)?.litros_ficha ?? 0;
                var ficha2 = group.ElementAtOrDefault(1)?.litros_ficha ?? 0;
                decimal total = ficha1 + ficha2;
                if (firstItem != null)
                {
                    <tr>
                        <td>@firstItem.C_envios_leche_g.C_establos.nombre_establo</td>
                        <td>@horas.ToShortDateString()</td>
                        <td>@firstItem.C_envios_leche_g.C_articulos_catalogo.nombre_articulo</td>
                        <td>@firstItem.C_envios_leche_g.C_envios_leche_clientes.nombre_comercial</td>
                        <td>@firstItem.C_envios_leche_g.C_envios_leche_destinos.nombre_destino</td>
                        <td>@firstItem.C_envios_leche_g.folio</td>
                        <td>@group.Sum(x => x.litros_ficha).Value.ToString("N3")</td>
                        <td class="text-center">
                            <button class="btn btn_beta_icon" onclick="EnvioConfirmadoPorAgrupar(@firstItem.id_envio_leche_g);"><i class="fa fa-list"></i></button>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
}
else
{
    <div class="col-md-12 text-center">
        <h2 style="color:red">No se encontró información</h2>
    </div>
}