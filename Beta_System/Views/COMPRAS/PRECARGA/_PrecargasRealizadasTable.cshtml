@model List<Beta_System.Models.C_compras_ordenes_precarga_g>

@if (Model.Count() > 0)
{
    foreach (var item in Model.OrderBy(x => x.C_compras_ordenes_g.C_compras_requi_g.C_usuarios_corporativo5.C_empleados.nombres))
    {
        var orden = item.C_compras_ordenes_g;
        <div class="" id="heading_@item.id_compras_orden_g">
            <div class="w-100 collapsed" style="border: 1px solid black; background-color: rgb(236, 244, 251);">
                <div class="row">
                    <div class="col-md-2 p-2 text-center">
                        <strong>Fecha: @string.Format(item.fecha_registro.Value.ToShortDateString(), "dd/mm/yyyy")</strong>
                        <br />
                        <input type="checkbox" name="checks_precargas_g" value="@item.id_precarga_g" class="form-control checks_precargas_g" style="min-height: 25px; width: 100%;" />
                        <strong>Orden #@item.id_compras_orden_g</strong>
                    </div>
                    <div class="col-md-3 p-3 text-lft">
                        <label>Destinatario: <strong class="text_beta">@item.C_compras_ordenes_g.C_compras_requi_g.C_usuarios_corporativo5.C_empleados.nombres.ToUpper() @item.C_compras_ordenes_g.C_compras_requi_g.C_usuarios_corporativo5.C_empleados.apellido_paterno.ToUpper()</strong></label>
                        <br />
                        <label>Repartidor <strong>@item.C_nomina_empleados.Nombres.ToUpper() @item.C_nomina_empleados.Apellido_paterno.ToUpper()</strong></label>
                    </div>
                    <div class="col-md-1 p-3 text-center">
                        <label>Artículos:</label>
                        <br />
                        <strong>@orden.C_compras_ordenes_d.Where(x => x.activo == true).Count()</strong>
                    </div>
                    <div class="col-md-1 p-3 text-center">
                        <label>Entregados:</label>
                        <br />
                        <strong>@orden.C_compras_ordenes_d.Where(x => x.activo == true && x.entregado == true).Count()</strong>
                    </div>
                    <div class="col-md-1 p-3 text-center">
                        <label>Pendientes:</label>
                        <br />
                        <strong>@orden.C_compras_ordenes_d.Where(x => x.activo == true && x.entregado == false).Count()</strong>
                    </div>
                    <div class="col-md-3 p-3 text-center">
                        <label>Ubicación de entrega</label>
                        <br />
                        <strong>@item.C_compras_ordenes_g.C_compras_ordenes_ubicaciones_entrega.nombre_ubicacion</strong>
                    </div>
                    <div class="col-md-1">
                        <br />
                        <button class="btn btn_beta_danger_icon" onclick="EliminarPrecarga(@item.id_precarga_g);"><i class="fa fa-remove"></i></button>
                        <button class="btn btn_beta_icon" data-toggle="collapse" data-target="#collapse_@item.id_compras_orden_g" aria-expanded="false" aria-controls="collapse_@item.id_compras_orden_g"><i class="fa fa-bars"></i></button>
                    </div>
                </div>
            </div>
        </div>
        <div id="collapse_@item.id_compras_orden_g" class="collapse btn_detalle_requi_aut" aria-labelledby="heading_@item.id_compras_orden_g" data-parent="#accordionSolicitudes">
            <div class="table-responsive">
                <table class="table table-striped table-bordered table-sm table-hover" id="datatable_precargas_realizadas">
                    <thead>
                        <tr class="bg-beta text-center">
                            @*<th>Seleccionar</th>*@
                            <th>Clave</th>
                            <th>Artículo</th>
                            <th>Unidad de medida</th>
                            <th>Cantidad solicitada</th>
                            <th>Cantidad pendiente</th>
                            <th>Cantidad precargada</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var detalle in item.C_compras_ordenes_precarga_d)
                        {
                            var pendiente = detalle.C_compras_ordenes_d.cantidad_compra - detalle.C_compras_ordenes_d.cantidad_entregada;
                            <tr class="text-center">
                                <td>@detalle.C_compras_ordenes_d.C_articulos_catalogo.clave</td>
                                <td class="text-left">@detalle.C_compras_ordenes_d.C_articulos_catalogo.nombre_articulo</td>
                                <td>@detalle.C_compras_ordenes_d.C_articulos_catalogo.C_unidades_medidas.unidad_medida</td>
                                <td>@detalle.C_compras_ordenes_d.cantidad_compra.Value.ToString("N2")</td>
                                <td>@pendiente.Value.ToString("N2")</td>
                                <td>@detalle.cantidad_precarga.Value.ToString("N2")</td>

                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
}
else
{
    <h3 class="text-center text-danger">No se encontró información</h3>
}


